## 围栏管理模块

### 更新围栏信息

#### 请求路径

```
PUT fence-service/fence/update
```

#### 说明

传入修改后的围栏信息，包括位置等，更新围栏信息

#### 请求参数

| 参数名 | 类型 | 必须 | 说明 |
| --- | --- | --- | --- |
| id | number | Y | 围栏id |
| fence_name | string | Y | 围栏名称 |
| capacity | number | Y | 围栏容量 |
| area | string | Y | 围栏归属区域 |
| fence_points | string | Y | 围栏坐标点数组 形似[\{ 'lng':102.222,'lat':109.223 \},...] |
| type | number | Y | 围栏类型 1:车辆运营区 2:指定停车区 |

#### 返回示例

```json
HTTP code: 200
{
    "code": 0,
    "msg": "更新成功",
    "data": {更新后的围栏数据}
}

HTTP code: 400
{
    "code": 1,
    "msg": "更新失败",
}
```

### 添加新围栏

#### 请求路径

```
POST fence-service/fence/save
```

#### 说明

添加一个新的围栏

#### 请求参数

| 参数名 | 类型 | 必须 | 说明 |
| --- | --- | --- | --- |
| id | number | Y | 围栏id |
| fence_name | string | Y | 围栏名称 |
| capacity | number | Y | 围栏容量 |
| area | string | Y | 围栏归属区域 |
| fence_points | string | Y | 围栏坐标点数组 形似[\{ 'lng':102.222,'lat':109.223 \},...] |
| type | number | Y | 围栏类型 1:车辆运营区 2:指定停车区 |

#### 返回示例

```json
HTTP code: 200
{
    "code": 0,
    "msg": "更新成功",
    "data": {"id":1} // 新增围栏的id
}
```

### 获取围栏列表

#### 请求路径

```
GET fence-service/fence/list
```

#### 说明

传入页码和每页数量，获取围栏列表

#### 请求参数

| 参数名 | 类型 | 必须 | 说明 |
| --- | --- | --- | --- |
| page | number | Y | 页码 |
| size | number | Y | 每页数量 |

#### 返回示例

```json
HTTP code: 200
{
    "msg": "查询成功",
    "code": 0,
    "data": {
        "count": 9,
        "list": [
            {
                "id": 3,
                "fence_name": "交大主校区",
                "capacity": 0,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.343584,\"lat\":39.958792},{\"lng\":116.343786,\"lat\":39.957942},{\"lng\":116.343,\"lat\":39.957786},{\"lng\":116.343135,\"lat\":39.957378},{\"lng\":116.343243,\"lat\":39.956887},{\"lng\":116.344002,\"lat\":39.957026},{\"lng\":116.344177,\"lat\":39.956642},{\"lng\":116.344541,\"lat\":39.956566},{\"lng\":116.344873,\"lat\":39.95648},{\"lng\":116.34512,\"lat\":39.956556},{\"lng\":116.345318,\"lat\":39.955902},{\"lng\":116.344478,\"lat\":39.955767},{\"lng\":116.345111,\"lat\":39.955249},{\"lng\":116.345592,\"lat\":39.9549},{\"lng\":116.345996,\"lat\":39.954686},{\"lng\":116.34623,\"lat\":39.954599},{\"lng\":116.34808,\"lat\":39.954831},{\"lng\":116.348192,\"lat\":39.954717},{\"lng\":116.348417,\"lat\":39.953922},{\"lng\":116.350101,\"lat\":39.954437},{\"lng\":116.349944,\"lat\":39.954831},{\"lng\":116.351125,\"lat\":39.955311},{\"lng\":116.352239,\"lat\":39.955875},{\"lng\":116.354395,\"lat\":39.9563},{\"lng\":116.354292,\"lat\":39.956639},{\"lng\":116.354458,\"lat\":39.956718},{\"lng\":116.354323,\"lat\":39.957112},{\"lng\":116.354395,\"lat\":39.957292},{\"lng\":116.354287,\"lat\":39.957541},{\"lng\":116.354265,\"lat\":39.957662},{\"lng\":116.353564,\"lat\":39.957541},{\"lng\":116.353411,\"lat\":39.958087},{\"lng\":116.353021,\"lat\":39.957838},{\"lng\":116.352338,\"lat\":39.957696},{\"lng\":116.352073,\"lat\":39.958495},{\"lng\":116.350546,\"lat\":39.958249},{\"lng\":116.350214,\"lat\":39.9593},{\"lng\":116.346418,\"lat\":39.958661},{\"lng\":116.346176,\"lat\":39.959228},{\"lng\":116.34358,\"lat\":39.958792}]",
                "create_date": "2023-06-06",
                "type": 1
            },
            {
                "id": 4,
                "fence_name": "交大东校区",
                "capacity": 50,
                "current_num": 40,
                "area": "北京海淀",
                "fence_points": "[{\"lng\":116.352545,\"lat\":39.951505},{\"lng\":116.35426,\"lat\":39.950952},{\"lng\":116.354476,\"lat\":39.951547},{\"lng\":116.354754,\"lat\":39.952031},{\"lng\":116.354323,\"lat\":39.954395},{\"lng\":116.355275,\"lat\":39.954478},{\"lng\":116.355195,\"lat\":39.95481},{\"lng\":116.351745,\"lat\":39.954499},{\"lng\":116.351862,\"lat\":39.953807},{\"lng\":116.352104,\"lat\":39.952895},{\"lng\":116.352293,\"lat\":39.951554},{\"lng\":116.352545,\"lat\":39.951491}]",
                "create_date": "2023-05-30",
                "type": 1
            },
            {
                "id": 5,
                "fence_name": "东操场南停车区",
                "capacity": 200,
                "current_num": 60,
                "area": "北京海淀",
                "fence_points": "[{\"lng\":116.350847,\"lat\":39.957565},{\"lng\":116.35091,\"lat\":39.957423},{\"lng\":116.352334,\"lat\":39.957682},{\"lng\":116.35228,\"lat\":39.957831},{\"lng\":116.350856,\"lat\":39.957568}]",
                "create_date": "2023-05-30",
                "type": 2
            },
            {
                "id": 6,
                "fence_name": "西操停车区",
                "capacity": 100,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.345241,\"lat\":39.957693},{\"lng\":116.345408,\"lat\":39.957738},{\"lng\":116.34552,\"lat\":39.957368},{\"lng\":116.345358,\"lat\":39.957333},{\"lng\":116.345246,\"lat\":39.957693}]",
                "create_date": "2023-06-06",
                "type": 2
            },
            {
                "id": 7,
                "fence_name": "体育馆停车区",
                "capacity": 100,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.343315,\"lat\":39.957264},{\"lng\":116.343377,\"lat\":39.957122},{\"lng\":116.343907,\"lat\":39.957216},{\"lng\":116.343836,\"lat\":39.957347},{\"lng\":116.343328,\"lat\":39.957264}]",
                "create_date": "2023-06-06",
                "type": 2
            },
            {
                "id": 8,
                "fence_name": "思源楼北停车区",
                "capacity": 100,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.346903,\"lat\":39.957347},{\"lng\":116.346957,\"lat\":39.957264},{\"lng\":116.347743,\"lat\":39.957396},{\"lng\":116.347689,\"lat\":39.957517},{\"lng\":116.346917,\"lat\":39.957354}]",
                "create_date": "2023-06-06",
                "type": 2
            },
            {
                "id": 9,
                "fence_name": "九教北停车区",
                "capacity": 50,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.348547,\"lat\":39.955892},{\"lng\":116.348601,\"lat\":39.955698},{\"lng\":116.348893,\"lat\":39.955757},{\"lng\":116.34883,\"lat\":39.955954},{\"lng\":116.348547,\"lat\":39.955895}]",
                "create_date": "2023-06-06",
                "type": 2
            },
            {
                "id": 10,
                "fence_name": "九教西停车区",
                "capacity": 100,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.348089,\"lat\":39.955384},{\"lng\":116.348147,\"lat\":39.955228},{\"lng\":116.348336,\"lat\":39.955277},{\"lng\":116.348264,\"lat\":39.955415},{\"lng\":116.348085,\"lat\":39.955387}]",
                "create_date": "2023-06-06",
                "type": 2
            },
            {
                "id": 11,
                "fence_name": "大坑停车区",
                "capacity": 50,
                "current_num": 0,
                "area": null,
                "fence_points": "[{\"lng\":116.344774,\"lat\":39.956801},{\"lng\":116.344523,\"lat\":39.956763},{\"lng\":116.344478,\"lat\":39.956618},{\"lng\":116.344914,\"lat\":39.95649},{\"lng\":116.345129,\"lat\":39.956569},{\"lng\":116.345039,\"lat\":39.956756},{\"lng\":116.344779,\"lat\":39.956811}]",
                "create_date": "2023-06-06",
                "type": 2
            }
        ]
    }
}
```

### 获取围栏统计图表数据

#### 请求路径

```
GET fence-service/fence/graph-data
```

#### 说明

获取围栏统计图表数据，用于echarts展示

#### 请求参数

无

#### 返回示例

```json
HTTP code: 200
{
    "msg": "获取图表数据成功",
    "code": 0,
    "data": [
        {
            "seriesData": [
                {
                    "name": "车辆运营区",
                    "value": 2
                },
                {
                    "name": "指定停车区",
                    "value": 7
                }
            ],
            "titleSubtext": "数据来自全部围栏",
            "seriesName": "围栏类型",
            "titleText": "围栏类型统计",
            "legendData": [
                "车辆运营区",
                "指定停车区"
            ]
        },
        {
            "seriesData": [
                {
                    "name": "东操场南停车区",
                    "value": 200
                },
                {
                    "name": "西操停车区",
                    "value": 100
                },
                {
                    "name": "体育馆停车区",
                    "value": 100
                },
                {
                    "name": "思源楼北停车区",
                    "value": 100
                },
                {
                    "name": "九教北停车区",
                    "value": 50
                },
                {
                    "name": "九教西停车区",
                    "value": 100
                },
                {
                    "name": "大坑停车区",
                    "value": 50
                }
            ],
            "titleSubtext": "数据来自全部围栏",
            "seriesName": "指定停车区",
            "titleText": "指定停车区统计",
            "legendData": [
                "东操场南停车区",
                "西操停车区",
                "体育馆停车区",
                "思源楼北停车区",
                "九教北停车区",
                "九教西停车区",
                "大坑停车区"
            ]
        }
    ]
}
```

### 传入位置检查是否在围栏内

#### 请求路径

```
GET fence-service/fence/check
```

#### 说明

传入经纬度坐标，进行围栏检查，先检查是否在运营区，再检查是否在指定停车区

#### 请求参数

| 参数名 | 类型 | 必须 | 说明 |
| --- | --- | --- | --- |
| longitude | number | Y | 经度 |
| latitude | number | Y | 纬度 |

#### 返回示例

```json
HTTP code: 200
{
    "msg": "检查成功",
    "code": 0,
    "data": {
        "isInFence": false
    }
}
```

### 删除围栏

#### 请求路径

```
DELETE fence-service/fence/delete
```

#### 说明

传入围栏id，删除围栏

#### 请求参数

| 参数名 | 类型 | 必须 | 说明 |
| --- | --- | --- | --- |
| id | number | Y | 围栏id |

#### 返回示例

```json
HTTP code: 200
{
    "msg": "删除成功",
    "code": 0,
    "data": null
}
```